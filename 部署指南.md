# Big-Market åç«¯å®Œæ•´éƒ¨ç½²æŒ‡å—

> æœ¬æŒ‡å—æä¾›ä»æœ¬åœ°æ„å»ºåˆ°äº‘æœåŠ¡å™¨éƒ¨ç½²çš„å®Œæ•´æµç¨‹ï¼ŒåŒ…å«å¸¸è§é—®é¢˜æ’æŸ¥å’Œè§£å†³æ–¹æ¡ˆï¼ŒæŒ‰ç…§æ­¥éª¤é¡ºåºæ‰§è¡Œå³å¯å®Œæˆéƒ¨ç½²ã€‚

## ğŸ“‹ éƒ¨ç½²æ¶æ„è¯´æ˜

```
å¼€å‘è€…
  â”œâ”€â”€ åç«¯æ„å»º (SpringBoot)
  â”‚   â”œâ”€â”€ Maven å®Œæ•´æ„å»º â†’ æ‰€æœ‰æ¨¡å— JAR åŒ…
  â”‚   â”œâ”€â”€ Docker æ„å»º â†’ é•œåƒæ–‡ä»¶
  â”‚   â””â”€â”€ æ¨é€é•œåƒ â†’ Docker Hub (ä½ çš„ç”¨æˆ·å/big-market-app)
  â”‚
  â””â”€â”€ äº‘æœåŠ¡å™¨éƒ¨ç½²
      â”œâ”€â”€ æ‹‰å–é•œåƒ â†’ ä» Docker Hub
      â”œâ”€â”€ Docker Compose ç¼–æ’
      â””â”€â”€ äº‘æœåŠ¡å™¨ (2C2G æ¨è) 
          â”œâ”€â”€ MySQL 8.0.32
          â”œâ”€â”€ Redis 7.2.0
          â””â”€â”€ Big Market App
```

---

## âš™ï¸ ç¬¬ä¸€æ­¥ï¼šå‰ç½®å‡†å¤‡

### 1.1 æœ¬åœ°å¼€å‘ç¯å¢ƒ

ç¡®ä¿ä½ çš„å¼€å‘æœºå·²å®‰è£…ï¼š

- âœ… **JDK 8** - `java -version` æ£€æŸ¥
- âœ… **Maven 3.6+** - `mvn -version` æ£€æŸ¥
- âœ… **Docker Desktop** - `docker --version` æ£€æŸ¥
- âœ… **Docker Hub è´¦å·** - æ³¨å†Œåœ°å€ï¼šhttps://hub.docker.com

### 1.2 äº‘æœåŠ¡å™¨ç¯å¢ƒ

**æ¨èé…ç½®**ï¼š
- CPU: 2æ ¸ä»¥ä¸Š
- å†…å­˜: 2GB ä»¥ä¸Šï¼ˆæ¨è 4GBï¼‰
- ç£ç›˜: 20GB ä»¥ä¸Š
- ç³»ç»Ÿ: CentOS 7+/Ubuntu 18.04+

**éœ€è¦å¼€æ”¾çš„ç«¯å£**ï¼š
- `22` - SSH ç™»å½•
- `8091` - åº”ç”¨æœåŠ¡ç«¯å£
- `3306` - MySQLï¼ˆå»ºè®®ä»…å†…ç½‘è®¿é—®ï¼‰
- `6379` - Redisï¼ˆå»ºè®®ä»…å†…ç½‘è®¿é—®ï¼‰

---

## ğŸ”¨ ç¬¬äºŒæ­¥ï¼šæœ¬åœ°å®Œæ•´æ„å»ºï¼ˆâš ï¸ é‡è¦ï¼‰

### 2.1 ç†è§£å¤šæ¨¡å—é¡¹ç›®ç»“æ„

**ä¸ºä»€ä¹ˆè¦ä»æ ¹ç›®å½•æ„å»ºï¼Ÿ**

æœ¬é¡¹ç›®æ˜¯ Maven å¤šæ¨¡å—é¡¹ç›®ï¼š
```
big-market/
â”œâ”€â”€ big-market-app/              # åº”ç”¨å¯åŠ¨æ¨¡å—
â”œâ”€â”€ big-market-domain/           # é¢†åŸŸå±‚
â”œâ”€â”€ big-market-infrastructure/   # åŸºç¡€è®¾æ–½å±‚ï¼ˆåŒ…å« RuleTree ç­‰ PO ç±»ï¼‰
â”œâ”€â”€ big-market-trigger/          # è§¦å‘å™¨å±‚
â”œâ”€â”€ big-market-types/            # ç±»å‹å®šä¹‰å±‚
â”œâ”€â”€ big-market-api/              # API å®šä¹‰å±‚
â””â”€â”€ pom.xml                      # çˆ¶ POM æ–‡ä»¶
```

**å…³é”®ç‚¹**ï¼š
- `big-market-app` ä¾èµ– `big-market-infrastructure`
- `big-market-infrastructure` åŒ…å« MyBatis çš„ PO ç±»ï¼ˆå¦‚ `RuleTree.java`ï¼‰
- å¦‚æœåªåœ¨ `big-market-app` ç›®å½•æ‰§è¡Œ `mvn package`ï¼ŒMaven ä¼šä»æœ¬åœ° `.m2` ç¼“å­˜æ‹¿"æ—§çš„" jar åŒ…
- è¿™ä¼šå¯¼è‡´ Docker é•œåƒä¸­ç¼ºå°‘æœ€æ–°çš„ç±»æ–‡ä»¶ï¼Œå¼•å‘ `ClassNotFoundException`

### 2.2 æ­£ç¡®çš„æ„å»ºæµç¨‹

**æ­¥éª¤ 1ï¼šè¿›å…¥é¡¹ç›®æ ¹ç›®å½•**

```bash
# Windows
cd C:\Users\ä½ çš„ç”¨æˆ·å\Desktop\mystudy\xfg-infra\big-market

# Mac/Linux
cd ~/workspace/big-market
```

**æ­¥éª¤ 2ï¼šå®Œæ•´æ„å»ºæ‰€æœ‰æ¨¡å—ï¼ˆæ ¸å¿ƒå‘½ä»¤ï¼‰**

```bash
# æ¸…ç†å¹¶å®‰è£…æ‰€æœ‰æ¨¡å—åˆ°æœ¬åœ°ä»“åº“
mvn clean install -DskipTests

# æˆ–è€…ä½¿ç”¨ï¼ˆæ•ˆæœç›¸åŒï¼‰
mvn clean install "-Dmaven.test.skip=true"
```

**ä¸ºä»€ä¹ˆç”¨ `install` è€Œä¸æ˜¯ `package`ï¼Ÿ**
- `package`ï¼šåªæ‰“åŒ…å½“å‰æ¨¡å—
- `install`ï¼šæ‰“åŒ…å¹¶å®‰è£…åˆ°æœ¬åœ° `.m2` ä»“åº“ï¼Œç¡®ä¿æ‰€æœ‰å­æ¨¡å—éƒ½æ˜¯æœ€æ–°ç‰ˆæœ¬

**ç­‰å¾…æ„å»ºå®Œæˆ**ï¼ˆçº¦ 2-5 åˆ†é’Ÿï¼‰ï¼Œä½ ä¼šçœ‹åˆ°ï¼š
```
[INFO] Reactor Summary:
[INFO] 
[INFO] big-market ......................................... SUCCESS [  0.123 s]
[INFO] big-market-types ................................... SUCCESS [  2.456 s]
[INFO] big-market-domain .................................. SUCCESS [  3.789 s]
[INFO] big-market-infrastructure .......................... SUCCESS [  4.567 s]
[INFO] big-market-trigger ................................. SUCCESS [  2.345 s]
[INFO] big-market-app ..................................... SUCCESS [  5.678 s]
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
```

**æ­¥éª¤ 3ï¼šéªŒè¯ JAR åŒ…**

```bash
# è¿›å…¥ app æ¨¡å—
cd big-market-app

# Windows
dir target\xfg-frame-archetype-lite-app.jar

# Mac/Linux
ls -lh target/xfg-frame-archetype-lite-app.jar
```

ä½ åº”è¯¥çœ‹åˆ°ä¸€ä¸ªå¤§çº¦ 50-80MB çš„ JAR æ–‡ä»¶ã€‚

---

## ğŸ³ ç¬¬ä¸‰æ­¥ï¼šæ„å»º Docker é•œåƒ

### 3.1 ç¡®è®¤ Dockerfile

ç¡®ä¿ `big-market-app/Dockerfile` æ–‡ä»¶å­˜åœ¨ä¸”å†…å®¹æ­£ç¡®ï¼š

```dockerfile
# åŸºç¡€é•œåƒ
FROM openjdk:8-jre-slim

# ä½œè€…
MAINTAINER windy

# é…ç½®
ENV PARAMS=""

# æ—¶åŒº
ENV TZ=PRC
RUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime && echo $TZ > /etc/timezone

# æ·»åŠ åº”ç”¨
ADD target/xfg-frame-archetype-lite-app.jar /xfg-frame-archetype-lite-app.jar

ENTRYPOINT ["sh","-c","java -jar $JAVA_OPTS /xfg-frame-archetype-lite-app.jar $PARAMS"]
```

### 3.2 æ„å»ºé•œåƒ

**é‡è¦**ï¼šå°† `<ä½ çš„DockerHubç”¨æˆ·å>` æ›¿æ¢ä¸ºä½ çš„å®é™… Docker Hub ç”¨æˆ·åï¼ˆä¾‹å¦‚ï¼šfuzhengweiï¼‰

```bash
# ç¡®ä¿åœ¨ big-market-app ç›®å½•ä¸‹
docker build -t <ä½ çš„DockerHubç”¨æˆ·å>/big-market-app:1.0-SNAPSHOT .

# ç¤ºä¾‹ï¼ˆæ›¿æ¢æˆä½ è‡ªå·±çš„ç”¨æˆ·åï¼‰ï¼š
# docker build -t fuzhengwei/big-market-app:1.0-SNAPSHOT .
```

**æ„å»ºè¿‡ç¨‹**å¤§çº¦éœ€è¦ 2-5 åˆ†é’Ÿï¼Œä½ ä¼šçœ‹åˆ°ï¼š
```
Step 1/7 : FROM openjdk:8-jre-slim
Step 2/7 : MAINTAINER xiaofuge
Step 3/7 : ENV PARAMS=""
...
Successfully built abc123def456
Successfully tagged fuzhengwei/big-market-app:1.0-SNAPSHOT
```

**éªŒè¯é•œåƒ**ï¼š
```bash
docker images | grep big-market-app
```

ä½ åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š
```
fuzhengwei/big-market-app   1.0-SNAPSHOT   abc123def456   2 minutes ago   200MB
```

---

## ğŸ“¤ ç¬¬å››æ­¥ï¼šæ¨é€é•œåƒåˆ° Docker Hub

### 4.1 ç™»å½• Docker Hub

```bash
docker login
```

è¾“å…¥ä½ çš„ Docker Hub ç”¨æˆ·åå’Œå¯†ç ï¼š
```
Username: ä½ çš„ç”¨æˆ·å
Password: ä½ çš„å¯†ç 
Login Succeeded
```

### 4.2 æ¨é€é•œåƒ

```bash
docker push <ä½ çš„DockerHubç”¨æˆ·å>/big-market-app:1.0-SNAPSHOT

# ç¤ºä¾‹ï¼š
# docker push fuzhengwei/big-market-app:1.0-SNAPSHOT
```

**æ¨é€è¿‡ç¨‹**å¯èƒ½éœ€è¦ 5-10 åˆ†é’Ÿï¼ˆå–å†³äºç½‘ç»œé€Ÿåº¦ï¼‰ï¼Œä½ ä¼šçœ‹åˆ°ï¼š
```
The push refers to repository [docker.io/fuzhengwei/big-market-app]
abc123def456: Pushed
def456ghi789: Pushed
...
1.0-SNAPSHOT: digest: sha256:abc123... size: 2345
```

**éªŒè¯æ¨é€æˆåŠŸ**ï¼š
è®¿é—® https://hub.docker.com/r/<ä½ çš„ç”¨æˆ·å>/big-market-app æŸ¥çœ‹é•œåƒæ˜¯å¦å·²ä¸Šä¼ ã€‚

---

## â˜ï¸ ç¬¬äº”æ­¥ï¼šäº‘æœåŠ¡å™¨å®‰è£… Docker ç¯å¢ƒ

### 5.1 SSH ç™»å½•æœåŠ¡å™¨

```bash
# ä½¿ç”¨ SSH ç™»å½•ä½ çš„äº‘æœåŠ¡å™¨
ssh root@ä½ çš„æœåŠ¡å™¨IP

# æˆ–ä½¿ç”¨å¯†é’¥ç™»å½•
ssh -i /path/to/your/key.pem root@ä½ çš„æœåŠ¡å™¨IP
```

### 5.2 å®‰è£… Docker

æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ˆCentOS/Ubuntu é€šç”¨ï¼‰ï¼š

```bash
# ä½¿ç”¨é˜¿é‡Œäº‘é•œåƒå®‰è£… Dockerï¼ˆå›½å†…é€Ÿåº¦å¿«ï¼‰
curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun

# å¯åŠ¨ Docker æœåŠ¡
systemctl enable docker
systemctl start docker

# éªŒè¯å®‰è£…
docker --version
```

ä½ åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š
```
Docker version 24.0.7, build afdd53b
```

### 5.3 å®‰è£… Docker Compose

```bash
# ä¸‹è½½ Docker Compose
curl -L "https://github.com/docker/compose/releases/download/v2.20.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose

# èµ‹äºˆæ‰§è¡Œæƒé™
chmod +x /usr/local/bin/docker-compose

# éªŒè¯å®‰è£…
docker-compose --version
```

ä½ åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š
```
Docker Compose version v2.20.0
```

---

## ğŸ“ ç¬¬å…­æ­¥ï¼šå‡†å¤‡éƒ¨ç½²ç›®å½•å’Œæ–‡ä»¶

### 6.1 åˆ›å»ºéƒ¨ç½²ç›®å½•

åœ¨äº‘æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼š

```bash
# åˆ›å»ºéƒ¨ç½²ç›®å½•
mkdir -p /opt/big-market/mysql/sql
mkdir -p /opt/big-market/log
scp docs/dev-ops/mysql/sql/big_market.sql ubuntu@101.35.20.38:~/workspace/big-market/big-market-app/mysql/sql/
# è¿›å…¥éƒ¨ç½²ç›®å½•
cd /opt/big-market
```

### 6.2 ä¸Šä¼ æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬

**åœ¨ä½ çš„æœ¬åœ°ç”µè„‘**æ‰§è¡Œï¼ˆæ‰“å¼€æ–°çš„å‘½ä»¤è¡Œçª—å£ï¼Œä¸è¦å…³é—­ SSH è¿æ¥ï¼‰ï¼š

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd big-market

# ä¸Šä¼  SQL æ–‡ä»¶åˆ°æœåŠ¡å™¨
scp docs/dev-ops/mysql/sql/big_market.sql root@ä½ çš„æœåŠ¡å™¨IP:/opt/big-market/mysql/sql/

# å¦‚æœä½¿ç”¨å¯†é’¥ç™»å½•
scp -i /path/to/your/key.pem docs/dev-ops/mysql/sql/big_market.sql root@ä½ çš„æœåŠ¡å™¨IP:/opt/big-market/mysql/sql/
```

**éªŒè¯ä¸Šä¼ æˆåŠŸ**ï¼ˆå›åˆ° SSH çª—å£ï¼‰ï¼š

```bash
ls -lh /opt/big-market/mysql/sql/
```

ä½ åº”è¯¥çœ‹åˆ° `big_market.sql` æ–‡ä»¶ã€‚

---

## ğŸ“ ç¬¬ä¸ƒæ­¥ï¼šåˆ›å»º docker-compose.yml é…ç½®æ–‡ä»¶

### 7.1 åˆ›å»ºé…ç½®æ–‡ä»¶

åœ¨äº‘æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼š

```bash
# ç¡®ä¿åœ¨ /opt/big-market ç›®å½•
cd /opt/big-market

# ä½¿ç”¨ vi æˆ– nano ç¼–è¾‘å™¨åˆ›å»ºæ–‡ä»¶
vi docker-compose.yml
```

### 7.2 å¤åˆ¶ä»¥ä¸‹å®Œæ•´é…ç½®

æŒ‰ `i` è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œç„¶åå¤åˆ¶ç²˜è´´ä»¥ä¸‹å†…å®¹ï¼š

**é‡è¦**ï¼šå°† `<ä½ çš„DockerHubç”¨æˆ·å>` æ›¿æ¢ä¸ºä½ çš„å®é™…ç”¨æˆ·åï¼

```yaml
version: '3.9'

services:
  # ==================== MySQL æ•°æ®åº“ ====================
  mysql:
    image: mysql:8.0.32
    container_name: big-market-mysql
    restart: always
    environment:
      TZ: Asia/Shanghai
      MYSQL_ROOT_PASSWORD: Gengtao011020@  # ç”Ÿäº§ç¯å¢ƒè¯·ä¿®æ”¹ä¸ºå¼ºå¯†ç 
      MYSQL_DATABASE: big_market
    ports:
      - "3306:3306"  # ç”Ÿäº§ç¯å¢ƒå»ºè®®åˆ é™¤æ­¤è¡Œï¼Œä¸å¯¹å¤–æš´éœ²
    volumes:
      - ./mysql/sql:/docker-entrypoint-initdb.d
      - mysql-data:/var/lib/mysql
    networks:
      - big-market-network
    command: --default-authentication-plugin=mysql_native_password
    healthcheck:
      test: ["CMD", "mysqladmin", "ping", "-h", "localhost"]
      interval: 10s
      timeout: 5s
      retries: 5

  # ==================== Redis ç¼“å­˜ ====================
  redis:
    image: redis:7.2.0
    container_name: big-market-redis
    restart: always
    ports:
      - "6379:6379"  # ç”Ÿäº§ç¯å¢ƒå»ºè®®åˆ é™¤æ­¤è¡Œï¼Œä¸å¯¹å¤–æš´éœ²
    volumes:
      - redis-data:/data
    networks:
      - big-market-network
    command: redis-server --appendonly yes
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 10s
      timeout: 5s
      retries: 5

  # ==================== Big Market åº”ç”¨ ====================
  big-market-app:
    image: <ä½ çš„DockerHubç”¨æˆ·å>/big-market-app:1.0-SNAPSHOT  # æ›¿æ¢ä¸ºä½ çš„ç”¨æˆ·å
    container_name: big-market-app
    restart: always
    depends_on:
      mysql:
        condition: service_healthy
      redis:
        condition: service_healthy
    ports:
      - "8091:8091"
    environment:
      - TZ=Asia/Shanghai
      - SPRING_PROFILES_ACTIVE=dev
      # æ•°æ®åº“é…ç½®ï¼ˆä½¿ç”¨å®¹å™¨å†…æœåŠ¡åï¼‰
      - SPRING_DATASOURCE_URL=jdbc:mysql://mysql:3306/big_market?useUnicode=true&characterEncoding=utf8&autoReconnect=true&zeroDateTimeBehavior=convertToNull&serverTimezone=UTC&useSSL=false
      - SPRING_DATASOURCE_USERNAME=root
      - SPRING_DATASOURCE_PASSWORD=Gengtao011020@  # ä¸ MySQL å¯†ç ä¿æŒä¸€è‡´
      # Redis é…ç½®ï¼ˆä½¿ç”¨å®¹å™¨å†…æœåŠ¡åï¼‰
      - REDIS_SDK_CONFIG_HOST=redis
      - REDIS_SDK_CONFIG_PORT=6379
      # JVM é…ç½®ï¼ˆæ ¹æ®æœåŠ¡å™¨é…ç½®è°ƒæ•´ï¼‰
      - JAVA_OPTS=-Xms512m -Xmx1024m -XX:+UseG1GC
    volumes:
      - ./log:/data/log
    networks:
      - big-market-network
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

# ==================== æ•°æ®å· ====================
volumes:
  mysql-data:
  redis-data:

# ==================== ç½‘ç»œ ====================
networks:
  big-market-network:
    driver: bridge
```

### 7.3 ä¿å­˜æ–‡ä»¶

- æŒ‰ `Esc` é”®é€€å‡ºç¼–è¾‘æ¨¡å¼
- è¾“å…¥ `:wq` ç„¶åæŒ‰ `Enter` ä¿å­˜å¹¶é€€å‡º

**éªŒè¯æ–‡ä»¶**ï¼š
```bash
cat docker-compose.yml
```

---

## ğŸš€ ç¬¬å…«æ­¥ï¼šå¯åŠ¨æœåŠ¡

### 8.1 åˆ†æ­¥å¯åŠ¨ï¼ˆæ¨èï¼‰

åœ¨äº‘æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼š

```bash
# ç¡®ä¿åœ¨éƒ¨ç½²ç›®å½•
cd /opt/big-market

# ç¬¬ä¸€æ­¥ï¼šå¯åŠ¨ MySQL å’Œ Redis
docker-compose up -d mysql redis
```

ä½ ä¼šçœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š
```
[+] Running 3/3
 âœ” Network big-market_big-market-network  Created
 âœ” Container big-market-mysql             Started
 âœ” Container big-market-redis             Started
```

**ç­‰å¾…æ•°æ®åº“åˆå§‹åŒ–**ï¼ˆå¤§çº¦ 30-60 ç§’ï¼‰ï¼š
```bash
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹ MySQL åˆå§‹åŒ–æ—¥å¿—
docker-compose logs mysql | grep "ready for connections"
```

å½“ä½ çœ‹åˆ° `ready for connections` æ—¶ï¼Œè¡¨ç¤º MySQL å·²å¯åŠ¨å®Œæˆã€‚

### 8.2 å¯åŠ¨åº”ç”¨

```bash
# å¯åŠ¨åº”ç”¨æœåŠ¡
docker-compose up -d big-market-app

# æŸ¥çœ‹åº”ç”¨å¯åŠ¨æ—¥å¿—
docker-compose logs -f big-market-app
```

**è§‚å¯Ÿæ—¥å¿—è¾“å‡º**ï¼Œç­‰å¾…çœ‹åˆ°ç±»ä¼¼ä¿¡æ¯ï¼š
```
Started Application in 45.123 seconds
Tomcat started on port(s): 8091 (http)
```

æŒ‰ `Ctrl+C` é€€å‡ºæ—¥å¿—æŸ¥çœ‹ï¼ˆä¸ä¼šåœæ­¢å®¹å™¨ï¼‰ã€‚

### 8.3 éªŒè¯æ‰€æœ‰æœåŠ¡çŠ¶æ€

```bash
docker-compose ps
```

ä½ åº”è¯¥çœ‹åˆ°æ‰€æœ‰æœåŠ¡éƒ½æ˜¯ `Up` çŠ¶æ€ï¼š
```
NAME                  STATUS         PORTS
big-market-app        Up (healthy)   0.0.0.0:8091->8091/tcp
big-market-mysql      Up (healthy)   0.0.0.0:3306->3306/tcp
big-market-redis      Up (healthy)   0.0.0.0:6379->6379/tcp
```

---

## âœ… ç¬¬ä¹æ­¥ï¼šæµ‹è¯•éªŒè¯

### 9.1 é…ç½®é˜²ç«å¢™

**CentOS ç³»ç»Ÿ**ï¼š
```bash
# å¼€æ”¾ 8091 ç«¯å£
firewall-cmd --permanent --add-port=8091/tcp
firewall-cmd --reload

# éªŒè¯è§„åˆ™
firewall-cmd --list-ports
```

**Ubuntu ç³»ç»Ÿ**ï¼š
```bash
# å¼€æ”¾ 8091 ç«¯å£
ufw allow 8091/tcp
ufw reload

# éªŒè¯è§„åˆ™
ufw status
```

**äº‘æœåŠ¡å™¨å®‰å…¨ç»„**ï¼š
- ç™»å½•ä½ çš„äº‘æœåŠ¡å•†æ§åˆ¶å°ï¼ˆé˜¿é‡Œäº‘/è…¾è®¯äº‘/AWSç­‰ï¼‰
- æ‰¾åˆ°å®‰å…¨ç»„è®¾ç½®
- æ·»åŠ å…¥ç«™è§„åˆ™ï¼šå…è®¸ TCP 8091 ç«¯å£

### 9.2 æµ‹è¯•æ¥å£

**åœ¨ä½ çš„æœ¬åœ°ç”µè„‘**æµè§ˆå™¨æˆ–å‘½ä»¤è¡Œæµ‹è¯•ï¼š

#### æµ‹è¯• 1ï¼šç­–ç•¥è£…é…æ¥å£

```bash
curl "http://ä½ çš„æœåŠ¡å™¨IP:8091/api/v1/raffle/strategy_armory?strategyId=1000001"
```

é¢„æœŸè¿”å›ï¼š
```json
{
  "code": "0000",
  "info": "è°ƒç”¨æˆåŠŸ",
  "data": true
}
```

#### æµ‹è¯• 2ï¼šæŸ¥è¯¢å¥–å“åˆ—è¡¨

```bash
curl -X POST "http://ä½ çš„æœåŠ¡å™¨IP:8091/api/v1/raffle/query_raffle_award_list" \
  -H "Content-Type: application/json" \
  -d '{"strategyId":1000001}'
```

é¢„æœŸè¿”å›å¥–å“åˆ—è¡¨ã€‚

#### æµ‹è¯• 3ï¼šæ‰§è¡ŒæŠ½å¥–

```bash
curl -X POST "http://ä½ çš„æœåŠ¡å™¨IP:8091/api/v1/raffle/random_raffle" \
  -H "Content-Type: application/json" \
  -d '{"strategyId":1000001}'
```

é¢„æœŸè¿”å›æŠ½ä¸­çš„å¥–å“ä¿¡æ¯ã€‚

### 9.3 æµè§ˆå™¨è®¿é—®

åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š
```
http://ä½ çš„æœåŠ¡å™¨IP:8091/api/v1/raffle/strategy_armory?strategyId=1000001
```

å¦‚æœçœ‹åˆ° JSON è¿”å›ï¼Œè¯´æ˜éƒ¨ç½²æˆåŠŸï¼ğŸ‰

---

## ğŸ› ï¸ ç¬¬åæ­¥ï¼šæ—¥å¸¸è¿ç»´å‘½ä»¤

### 10.1 æŸ¥çœ‹æœåŠ¡çŠ¶æ€

```bash
# æŸ¥çœ‹æ‰€æœ‰å®¹å™¨çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯
docker ps

# æŸ¥çœ‹èµ„æºä½¿ç”¨æƒ…å†µ
docker stats
```

### 10.2 æŸ¥çœ‹æ—¥å¿—

```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—ï¼ˆå®æ—¶ï¼‰
docker-compose logs -f big-market-app

# æŸ¥çœ‹ MySQL æ—¥å¿—
docker-compose logs -f mysql

# æŸ¥çœ‹ Redis æ—¥å¿—
docker-compose logs -f redis

# æŸ¥çœ‹æœ€è¿‘ 100 è¡Œæ—¥å¿—
docker-compose logs --tail=100 big-market-app
```

### 10.3 é‡å¯æœåŠ¡

```bash
# é‡å¯åº”ç”¨
docker-compose restart big-market-app

# é‡å¯æ‰€æœ‰æœåŠ¡
docker-compose restart

# åœæ­¢æ‰€æœ‰æœåŠ¡
docker-compose stop

# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose start
```

### 10.4 æ›´æ–°åº”ç”¨

å½“ä½ æ›´æ–°äº†ä»£ç å¹¶æ¨é€äº†æ–°é•œåƒåï¼š

```bash
# æ‹‰å–æœ€æ–°é•œåƒ
docker pull ä½ çš„ç”¨æˆ·å/big-market-app:1.0-SNAPSHOT

# é‡æ–°åˆ›å»ºå¹¶å¯åŠ¨åº”ç”¨å®¹å™¨
docker-compose up -d big-market-app

# æŸ¥çœ‹æ›´æ–°æ—¥å¿—
docker-compose logs -f big-market-app
```

### 10.5 æ¸…ç†å’Œç»´æŠ¤

```bash
# åœæ­¢å¹¶åˆ é™¤æ‰€æœ‰å®¹å™¨ï¼ˆä¿ç•™æ•°æ®ï¼‰
docker-compose down

# åœæ­¢å¹¶åˆ é™¤æ‰€æœ‰å®¹å™¨å’Œæ•°æ®å·ï¼ˆå±é™©ï¼ä¼šä¸¢å¤±æ•°æ®ï¼‰
docker-compose down -v

# æ¸…ç†æœªä½¿ç”¨çš„é•œåƒ
docker image prune -a

# æŸ¥çœ‹ç£ç›˜ä½¿ç”¨
docker system df
```

---

## â“ å¸¸è§é—®é¢˜æ’æŸ¥

### âš ï¸ é—®é¢˜ 1ï¼š502 é”™è¯¯ + ClassNotFoundExceptionï¼ˆæœ€å¸¸è§ï¼‰

#### é—®é¢˜ç°è±¡

**ç—‡çŠ¶**ï¼š
1. è®¿é—®æ¥å£è¿”å› `502 Bad Gateway` é”™è¯¯
2. æŸ¥çœ‹åº”ç”¨æ—¥å¿—æ˜¾ç¤ºï¼š
```
Application run failed
java.lang.ClassNotFoundException: Cannot find class: cn.bugstack.infrastructure.dao.po.RuleTree
```

#### é—®é¢˜åˆ†æ

**è¡¨é¢ç°è±¡**ï¼š
- MyBatis åœ¨ `rule_tree_mapper.xml` æ–‡ä»¶é‡Œæ‰¾ä¸åˆ° `RuleTree` è¿™ä¸ª Java ç±»

**æ·±å±‚åŸå› **ï¼š
1. é¡¹ç›®æ˜¯å¤šæ¨¡å—çš„ï¼ˆ`app`, `infrastructure`, `domain` ç­‰ï¼‰
2. `RuleTree.java` åœ¨ `infrastructure` æ¨¡å—ä¸­
3. ä½ åªåœ¨ `big-market-app` æ¨¡å—ä¸‹è¿è¡Œäº† `mvn package`
4. Maven æ²¡æœ‰é‡æ–°ç¼–è¯‘ `infrastructure` æ¨¡å—ï¼Œè€Œæ˜¯ä»æœ¬åœ° `.m2` ç¼“å­˜é‡Œæ‹¿äº†ä¸€ä¸ª**"æ—§çš„"** `infrastructure.jar`
5. è¿™ä¸ª"æ—§ jar"é‡Œæ ¹æœ¬æ²¡æœ‰ä½ æ–°åŠ çš„ `RuleTree.class` æ–‡ä»¶
6. æœ€ç»ˆï¼Œ`docker build` äº†ä¸€ä¸ª"åæ‰çš„"é•œåƒï¼ˆåŒ…å«äº†"æ–°"çš„ xml å’Œ"æ—§"çš„ jarï¼‰

#### å®Œæ•´è§£å†³æ–¹æ¡ˆ

**ã€äº‘æœåŠ¡å™¨ã€‘ç¬¬ä¸€æ­¥ï¼šæ¸…ç†æ—§æœåŠ¡**

```bash
# è¿›å…¥éƒ¨ç½²ç›®å½•
cd ~/workspace/big-market/big-market-app

# åœæ­¢å¹¶ç§»é™¤"åæ‰çš„"æœåŠ¡
sudo docker-compose down
```

**ã€æœ¬åœ°ç”µè„‘ã€‘ç¬¬äºŒæ­¥ï¼šå½»åº•é‡æ–°æ‰“åŒ…**

```bash
# 1. é€€å›åˆ°é¡¹ç›®æ ¹ç›®å½•ï¼ˆé‡è¦ï¼ï¼‰
cd C:\Users\XduAI\Desktop\mystudy\xfg-infra\big-market

# 2. å®Œæ•´æ„å»ºæ‰€æœ‰æ¨¡å—ï¼ˆæ ¸å¿ƒå‘½ä»¤ï¼ï¼‰
mvn clean install -DskipTests

# æˆ–è€…ä½¿ç”¨
mvn clean install "-Dmaven.test.skip=true"
```

**ä¸ºä»€ä¹ˆè¿™æ ·åšï¼Ÿ**
- `install` å‘½ä»¤ä¼šç¼–è¯‘æ‰€æœ‰æ¨¡å—
- å¹¶æŠŠæœ€æ–°çš„ `infrastructure.jar` è£…å…¥æœ¬åœ° `.m2` ç¼“å­˜
- ç¡®ä¿åç»­æ‰“åŒ…æ—¶ä½¿ç”¨çš„æ˜¯æœ€æ–°çš„ä¾èµ–

**ã€æœ¬åœ°ç”µè„‘ã€‘ç¬¬ä¸‰æ­¥ï¼šé‡æ–°æ„å»ºå¹¶æ¨é€é•œåƒ**

```bash
# 1. è¿›å…¥ app æ¨¡å—
cd big-market-app

# 2. ç”¨æœ€æ–°çš„ jar åŒ…æ„å»º"å¥½çš„"é•œåƒ
docker build -t ä½ çš„ç”¨æˆ·å/big-market-app:1.0-SNAPSHOT .

# ç¤ºä¾‹ï¼š
# docker build -t windy701/big-market-app:1.0-SNAPSHOT .

# 3. æ¨é€"å¥½çš„"é•œåƒåˆ° Docker Hub
docker push ä½ çš„ç”¨æˆ·å/big-market-app:1.0-SNAPSHOT
```

**ã€äº‘æœåŠ¡å™¨ã€‘ç¬¬å››æ­¥ï¼šé‡æ–°éƒ¨ç½²**

```bash
# 1. è¿›å…¥éƒ¨ç½²ç›®å½•
cd ~/workspace/big-market/big-market-app

# 2. ä» Docker Hub æ‹‰å–ä½ åˆšæ¨é€çš„"å¥½çš„"é•œåƒ
sudo docker-compose pull

# 3. ç”¨"å¥½çš„"é•œåƒå¯åŠ¨æœåŠ¡
sudo docker-compose up -d

# 4. æŸ¥çœ‹å¯åŠ¨æ—¥å¿—ï¼Œç¡®è®¤æˆåŠŸ
sudo docker-compose logs -f big-market-app
```

**ã€æœ€ç»ˆéªŒè¯ã€‘æˆåŠŸæ ‡å¿—**

åœ¨æ—¥å¿—ä¸­çœ‹åˆ°ï¼š
```
Started Application in 45.123 seconds
Tomcat started on port(s): 8091 (http)
```

åœ¨æœ¬åœ°æµ‹è¯•æ¥å£ï¼š
```bash
curl "http://ä½ çš„æœåŠ¡å™¨IP:8091/api/v1/raffle/strategy_armory?strategyId=100001"
```

è¿”å›ï¼š
```json
{
  "code": "0000",
  "info": "è°ƒç”¨æˆåŠŸ",
  "data": true
}
```

**StatusCode: 200** âœ… éƒ¨ç½²æˆåŠŸï¼

---

### é—®é¢˜ 2ï¼šåº”ç”¨æ— æ³•è¿æ¥æ•°æ®åº“

**ç—‡çŠ¶**ï¼šåº”ç”¨æ—¥å¿—æ˜¾ç¤º `Connection refused` æˆ– `Unknown database`

**æ’æŸ¥æ­¥éª¤**ï¼š
```bash
# 1. æ£€æŸ¥ MySQL æ˜¯å¦æ­£å¸¸è¿è¡Œ
docker-compose ps mysql

# 2. æŸ¥çœ‹ MySQL æ—¥å¿—
docker-compose logs mysql | tail -50

# 3. æµ‹è¯•ç½‘ç»œè¿é€šæ€§
docker exec big-market-app ping mysql

# 4. æ‰‹åŠ¨è¿æ¥ MySQL æµ‹è¯•
docker exec -it big-market-mysql mysql -uroot -pä½ çš„å¯†ç  -e "SHOW DATABASES;"
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç¡®ä¿ MySQL å®¹å™¨çŠ¶æ€ä¸º `Up (healthy)`
- æ£€æŸ¥ docker-compose.yml ä¸­çš„å¯†ç æ˜¯å¦ä¸€è‡´
- ç­‰å¾… MySQL å®Œå…¨å¯åŠ¨ï¼ˆé¦–æ¬¡éœ€è¦ 1-2 åˆ†é’Ÿï¼‰

### é—®é¢˜ 3ï¼šç«¯å£è¢«å ç”¨

**ç—‡çŠ¶**ï¼šå¯åŠ¨æ—¶æç¤º `port is already allocated`

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
netstat -tlnp | grep 8091

# åœæ­¢å ç”¨ç«¯å£çš„è¿›ç¨‹
kill -9 è¿›ç¨‹ID

# æˆ–ä¿®æ”¹ docker-compose.yml ä¸­çš„ç«¯å£æ˜ å°„
# å°† "8091:8091" æ”¹ä¸º "8092:8091"
```

### é—®é¢˜ 4ï¼šå†…å­˜ä¸è¶³

**ç—‡çŠ¶**ï¼šå®¹å™¨é¢‘ç¹é‡å¯ï¼Œæ—¥å¿—æ˜¾ç¤º `OutOfMemoryError`

**è§£å†³æ–¹æ¡ˆ**ï¼š
ä¿®æ”¹ docker-compose.yml ä¸­çš„ JVM é…ç½®ï¼š
```yaml
- JAVA_OPTS=-Xms256m -Xmx512m -XX:+UseG1GC  # é™ä½å†…å­˜ä½¿ç”¨
```

### é—®é¢˜ 5ï¼šRedis ç¼“å­˜æœªç”Ÿæ•ˆ

**ç—‡çŠ¶**ï¼šä¿®æ”¹æ•°æ®åº“åè§„åˆ™æœªæ›´æ–°

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ¸…ç©º Redis ç¼“å­˜
docker exec big-market-redis redis-cli FLUSHALL

# æˆ–æ¸…é™¤ç‰¹å®š key
docker exec big-market-redis redis-cli KEYS "rule_tree_vo_key_*"
docker exec big-market-redis redis-cli DEL keyåç§°

# é‡å¯åº”ç”¨
docker-compose restart big-market-app
```

### é—®é¢˜ 6ï¼šé•œåƒæ‹‰å–å¤±è´¥

**ç—‡çŠ¶**ï¼š`Error response from daemon: pull access denied`

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# 1. æ£€æŸ¥é•œåƒåç§°æ˜¯å¦æ­£ç¡®
# 2. ç¡®è®¤é•œåƒå·²æ¨é€åˆ° Docker Hub
# 3. å¦‚æœæ˜¯ç§æœ‰é•œåƒï¼Œå…ˆç™»å½•
docker login

# 4. æ‰‹åŠ¨æ‹‰å–æµ‹è¯•
docker pull ä½ çš„ç”¨æˆ·å/big-market-app:1.0-SNAPSHOT
```

---

## ğŸ”„ é¡¹ç›®æ›´æ–°éƒ¨ç½²æµç¨‹

### å½“ä½ ä¿®æ”¹äº†ä»£ç éœ€è¦é‡æ–°éƒ¨ç½²æ—¶

**å®Œæ•´æµç¨‹**ï¼ˆæ¯æ¬¡æ›´æ–°éƒ½è¦èµ°è¿™ä¸ªæµç¨‹ï¼‰ï¼š

#### ã€æœ¬åœ°ç”µè„‘ã€‘æ­¥éª¤ 1ï¼šå®Œæ•´æ„å»º

```bash
# 1. å›åˆ°é¡¹ç›®æ ¹ç›®å½•
cd C:\Users\XduAI\Desktop\mystudy\xfg-infra\big-market

# 2. å®Œæ•´æ„å»ºæ‰€æœ‰æ¨¡å—ï¼ˆç¡®ä¿ä¾èµ–æœ€æ–°ï¼‰
mvn clean install -DskipTests
```

#### ã€æœ¬åœ°ç”µè„‘ã€‘æ­¥éª¤ 2ï¼šé‡æ–°æ„å»ºé•œåƒ

```bash
# 1. è¿›å…¥ app æ¨¡å—
cd big-market-app

# 2. æ„å»ºæ–°é•œåƒ
docker build -t ä½ çš„ç”¨æˆ·å/big-market-app:1.0-SNAPSHOT .

# 3. æ¨é€åˆ° Docker Hub
docker push ä½ çš„ç”¨æˆ·å/big-market-app:1.0-SNAPSHOT
```

#### ã€äº‘æœåŠ¡å™¨ã€‘æ­¥éª¤ 3ï¼šæ›´æ–°éƒ¨ç½²

```bash
# 1. è¿›å…¥éƒ¨ç½²ç›®å½•
cd ~/workspace/big-market/big-market-app

# 2. åœæ­¢æ—§æœåŠ¡
sudo docker-compose down

# 3. æ‹‰å–æ–°é•œåƒ
sudo docker-compose pull

# 4. å¯åŠ¨æ–°æœåŠ¡
sudo docker-compose up -d

# 5. æŸ¥çœ‹å¯åŠ¨æ—¥å¿—
sudo docker-compose logs -f big-market-app
```

#### ã€æœ¬åœ°ç”µè„‘ã€‘æ­¥éª¤ 4ï¼šéªŒè¯æ›´æ–°

```bash
# æµ‹è¯•æ¥å£
curl "http://ä½ çš„æœåŠ¡å™¨IP:8091/api/v1/raffle/strategy_armory?strategyId=100001"
```

### å¿«é€Ÿæ›´æ–°ï¼ˆä»…åº”ç”¨å±‚ä»£ç å˜æ›´ï¼‰

å¦‚æœä½ **ç¡®å®š**åªä¿®æ”¹äº† `big-market-app` æ¨¡å—çš„ä»£ç ï¼Œå¯ä»¥ä½¿ç”¨å¿«é€Ÿæµç¨‹ï¼š

```bash
# æœ¬åœ°ï¼šå¿«é€Ÿæ„å»º
cd big-market-app
mvn clean package -DskipTests
docker build -t ä½ çš„ç”¨æˆ·å/big-market-app:1.0-SNAPSHOT .
docker push ä½ çš„ç”¨æˆ·å/big-market-app:1.0-SNAPSHOT

# æœåŠ¡å™¨ï¼šå¿«é€Ÿæ›´æ–°
cd ~/workspace/big-market/big-market-app
sudo docker-compose pull
sudo docker-compose up -d big-market-app
```

**âš ï¸ æ³¨æ„**ï¼šå¦‚æœä¿®æ”¹äº† `infrastructure`ã€`domain`ã€`trigger` ç­‰æ¨¡å—ï¼Œ**å¿…é¡»**ä½¿ç”¨å®Œæ•´æµç¨‹ï¼

---

## ğŸ”’ ç”Ÿäº§ç¯å¢ƒå®‰å…¨å»ºè®®

### 1. ä¿®æ”¹é»˜è®¤å¯†ç 

ç¼–è¾‘ docker-compose.ymlï¼Œä¿®æ”¹ï¼š
```yaml
MYSQL_ROOT_PASSWORD: ä½ çš„å¼ºå¯†ç   # ä½¿ç”¨å¤æ‚å¯†ç 
```

### 2. å…³é—­å…¬ç½‘ç«¯å£

åˆ é™¤æˆ–æ³¨é‡Šæ‰ä¸éœ€è¦çš„ç«¯å£æ˜ å°„ï¼š
```yaml
# ports:
#   - "3306:3306"  # MySQL ä¸å¯¹å¤–æš´éœ²
#   - "6379:6379"  # Redis ä¸å¯¹å¤–æš´éœ²
```

### 3. é…ç½® HTTPS

ä½¿ç”¨ Nginx åå‘ä»£ç†å¹¶é…ç½® SSL è¯ä¹¦ï¼š
```bash
# å®‰è£… Nginx
yum install nginx -y  # CentOS
apt install nginx -y  # Ubuntu

# é…ç½®åå‘ä»£ç†åˆ° 8091 ç«¯å£
# ä½¿ç”¨ Let's Encrypt å…è´¹è¯ä¹¦
```

### 4. å®šæœŸå¤‡ä»½æ•°æ®

```bash
# å¤‡ä»½ MySQL
docker exec big-market-mysql mysqldump -uroot -på¯†ç  big_market > backup_$(date +%Y%m%d).sql

# å¤‡ä»½ Redis
docker exec big-market-redis redis-cli BGSAVE
docker cp big-market-redis:/data/dump.rdb ./backup/
```

### 5. ç›‘æ§å’Œæ—¥å¿—

- é…ç½®æ—¥å¿—æ”¶é›†ï¼ˆELK/Lokiï¼‰
- è®¾ç½®ç›‘æ§å‘Šè­¦ï¼ˆPrometheus/Grafanaï¼‰
- å®šæœŸæŸ¥çœ‹æœåŠ¡å™¨èµ„æºä½¿ç”¨æƒ…å†µ

---

## ğŸ“š é™„å½•ï¼šå…³é”®æ–‡ä»¶ä½ç½®

| æ–‡ä»¶/ç›®å½• | ä½ç½® | è¯´æ˜ |
|----------|------|------|
| åº”ç”¨ JAR | `big-market-app/target/xfg-frame-archetype-lite-app.jar` | æ„å»ºäº§ç‰© |
| Dockerfile | `big-market-app/Dockerfile` | é•œåƒæ„å»ºæ–‡ä»¶ |
| æ•°æ®åº“è„šæœ¬ | `docs/dev-ops/mysql/sql/big_market.sql` | åˆå§‹åŒ– SQL |
| Docker Compose | `/opt/big-market/docker-compose.yml` | æœåŠ¡ç¼–æ’é…ç½® |
| åº”ç”¨æ—¥å¿— | `/opt/big-market/log/` | åº”ç”¨è¿è¡Œæ—¥å¿— |
| MySQL æ•°æ® | Docker Volume `mysql-data` | æ•°æ®åº“æ•°æ® |
| Redis æ•°æ® | Docker Volume `redis-data` | ç¼“å­˜æ•°æ® |

---

## ğŸ“Œ å…³é”®è¦ç‚¹æ€»ç»“

### âœ… å¿…é¡»è®°ä½çš„æ ¸å¿ƒåŸåˆ™

1. **æ°¸è¿œä»é¡¹ç›®æ ¹ç›®å½•æ„å»º**
   ```bash
   cd big-market  # æ ¹ç›®å½•
   mvn clean install -DskipTests  # ä¸æ˜¯ packageï¼
   ```

2. **ç†è§£å¤šæ¨¡å—ä¾èµ–å…³ç³»**
   - `big-market-app` ä¾èµ–å…¶ä»–æ‰€æœ‰æ¨¡å—
   - ä¿®æ”¹ä»»ä½•å­æ¨¡å—åï¼Œéƒ½è¦ç”¨ `install` é‡æ–°æ„å»º
   - `package` åªæ‰“åŒ…å½“å‰æ¨¡å—ï¼Œ`install` ä¼šæ›´æ–°æœ¬åœ°ä»“åº“

3. **å®Œæ•´çš„æ›´æ–°æµç¨‹**
   ```
   æœ¬åœ°ï¼šmvn clean install â†’ docker build â†’ docker push
   æœåŠ¡å™¨ï¼šdocker-compose down â†’ pull â†’ up -d
   ```

4. **é‡åˆ° ClassNotFoundException æ—¶**
   - ç¬¬ä¸€ååº”ï¼šæ˜¯ä¸æ˜¯æ²¡æœ‰ç”¨ `mvn install`ï¼Ÿ
   - ç¬¬äºŒååº”ï¼šæ˜¯ä¸æ˜¯åœ¨å­æ¨¡å—ç›®å½•æ‰§è¡Œçš„æ„å»ºï¼Ÿ
   - è§£å†³æ–¹æ¡ˆï¼šå›åˆ°æ ¹ç›®å½•ï¼Œé‡æ–° `mvn clean install`

### ğŸ¯ éƒ¨ç½²æ£€æŸ¥æ¸…å•

**é¦–æ¬¡éƒ¨ç½²å‰**ï¼š
- [ ] JDK 8 å·²å®‰è£…
- [ ] Maven 3.6+ å·²å®‰è£…
- [ ] Docker Desktop å·²å®‰è£…å¹¶è¿è¡Œ
- [ ] Docker Hub è´¦å·å·²æ³¨å†Œ
- [ ] äº‘æœåŠ¡å™¨å·²å‡†å¤‡å¥½ï¼ˆ2C2G+ï¼‰
- [ ] å®‰å…¨ç»„å·²å¼€æ”¾ 8091 ç«¯å£

**æ„å»ºé˜¶æ®µ**ï¼š
- [ ] åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ `mvn clean install`
- [ ] çœ‹åˆ° `BUILD SUCCESS` å’Œæ‰€æœ‰æ¨¡å—åˆ—è¡¨
- [ ] éªŒè¯ JAR åŒ…å¤§å°ï¼ˆ50-80MBï¼‰
- [ ] Docker é•œåƒæ„å»ºæˆåŠŸ
- [ ] é•œåƒå·²æ¨é€åˆ° Docker Hub

**éƒ¨ç½²é˜¶æ®µ**ï¼š
- [ ] æœåŠ¡å™¨å·²å®‰è£… Docker å’Œ Docker Compose
- [ ] æ•°æ®åº“è„šæœ¬å·²ä¸Šä¼ 
- [ ] docker-compose.yml å·²æ­£ç¡®é…ç½®
- [ ] MySQL å’Œ Redis å®¹å™¨çŠ¶æ€ä¸º healthy
- [ ] åº”ç”¨æ—¥å¿—æ˜¾ç¤º `Started Application`
- [ ] æ¥å£æµ‹è¯•è¿”å› 200

### ğŸš¨ å¸¸è§é”™è¯¯é¿å…

| é”™è¯¯æ“ä½œ | æ­£ç¡®æ“ä½œ |
|---------|---------|
| `cd big-market-app && mvn package` | `cd big-market && mvn clean install` |
| åªä¿®æ”¹ä»£ç å°± `docker build` | å…ˆ `mvn clean install`ï¼Œå† `docker build` |
| ä¿®æ”¹äº† infrastructure ä½†åª package app | å¿…é¡»åœ¨æ ¹ç›®å½• `mvn clean install` |
| å¿˜è®° `docker push` å°±åœ¨æœåŠ¡å™¨ `pull` | å…ˆ pushï¼Œå† pull |
| `docker-compose up` ä¸åŠ  `-d` | åŠ  `-d` åå°è¿è¡Œï¼Œæˆ–ç”¨ `Ctrl+C` é€€å‡º |

---

## ğŸ‰ éƒ¨ç½²å®Œæˆ

æ­å–œï¼ä½ å·²ç»æˆåŠŸå®Œæˆ Big Market åç«¯çš„å®Œæ•´éƒ¨ç½²ã€‚

### éƒ¨ç½²æˆåŠŸçš„æ ‡å¿—

âœ… åº”ç”¨æ—¥å¿—æ˜¾ç¤ºï¼š
```
Started Application in XX seconds
Tomcat started on port(s): 8091 (http)
```

âœ… æ¥å£æµ‹è¯•è¿”å›ï¼š
```json
{
  "code": "0000",
  "info": "è°ƒç”¨æˆåŠŸ",
  "data": true
}
```

âœ… å®¹å™¨çŠ¶æ€å…¨éƒ¨ healthyï¼š
```
big-market-app        Up (healthy)
big-market-mysql      Up (healthy)
big-market-redis      Up (healthy)
```

### ä¸‹ä¸€æ­¥å»ºè®®

**åŠŸèƒ½æ‰©å±•**ï¼š
1. éƒ¨ç½²å‰ç«¯åº”ç”¨ï¼ˆå¦‚æœæœ‰ï¼‰
2. é…ç½®åŸŸåå’Œ HTTPS
3. æ·»åŠ  Nginx åå‘ä»£ç†
4. é›†æˆæ—¥å¿—æ”¶é›†ç³»ç»Ÿ

**è¿ç»´ä¼˜åŒ–**ï¼š
1. è®¾ç½®ç›‘æ§å’Œå‘Šè­¦ï¼ˆPrometheus + Grafanaï¼‰
2. é…ç½®è‡ªåŠ¨å¤‡ä»½è„šæœ¬
3. è¿›è¡Œå‹åŠ›æµ‹è¯•å’Œæ€§èƒ½ä¼˜åŒ–
4. ç¼–å†™è¿ç»´æ–‡æ¡£å’Œåº”æ€¥é¢„æ¡ˆ

**å®‰å…¨åŠ å›º**ï¼š
1. ä¿®æ”¹æ‰€æœ‰é»˜è®¤å¯†ç 
2. å…³é—­ä¸å¿…è¦çš„å…¬ç½‘ç«¯å£
3. é…ç½®é˜²ç«å¢™è§„åˆ™
4. å®šæœŸæ›´æ–°ç³»ç»Ÿå’Œä¾èµ–

### è·å–å¸®åŠ©

**é‡åˆ°é—®é¢˜**ï¼š
1. å…ˆæŸ¥çœ‹æœ¬æŒ‡å—çš„"å¸¸è§é—®é¢˜æ’æŸ¥"ç« èŠ‚
2. æŸ¥çœ‹å®¹å™¨æ—¥å¿—ï¼š`docker-compose logs -f big-market-app`
3. æ£€æŸ¥å®¹å™¨çŠ¶æ€ï¼š`docker-compose ps`
4. éªŒè¯ç½‘ç»œè¿é€šæ€§ï¼š`docker exec big-market-app ping mysql`

**æŠ€æœ¯äº¤æµ**ï¼š
- é¡¹ç›®åœ°å€ï¼šhttps://github.com/fuzhengwei/big-market
- é—®é¢˜åé¦ˆï¼šæäº¤ GitHub Issue
- æŠ€æœ¯åšå®¢ï¼šæŸ¥çœ‹ä½œè€…æŠ€æœ¯æ–‡ç« 

---

## ğŸ“ ç‰ˆæœ¬è®°å½•

| ç‰ˆæœ¬ | æ—¥æœŸ | æ›´æ–°å†…å®¹ |
|-----|------|---------|
| v1.0 | 2024-11-10 | åˆå§‹ç‰ˆæœ¬ |
| v1.1 | 2024-11-10 | æ·»åŠ  ClassNotFoundException å®Œæ•´è§£å†³æ–¹æ¡ˆ |
| v1.2 | 2024-11-10 | æ·»åŠ é¡¹ç›®æ›´æ–°æµç¨‹å’Œå…³é”®è¦ç‚¹æ€»ç»“ |

---

**ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼** ğŸš€

**è®°ä½**ï¼šé‡åˆ°é—®é¢˜ä¸è¦æ…Œï¼Œ90% çš„éƒ¨ç½²é—®é¢˜éƒ½æ˜¯å› ä¸ºæ²¡æœ‰åœ¨æ ¹ç›®å½•æ‰§è¡Œ `mvn clean install`ï¼


